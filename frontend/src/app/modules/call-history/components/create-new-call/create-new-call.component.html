<form [formGroup]="newCallForm" (ngSubmit)="submit()">
  <tui-input
    formControlName="callName"
    tuiHintContent="Specific name of your call">
    Name
  </tui-input>
  <app-form-control-validation [control]="nameField" caption="Name"></app-form-control-validation>
  <tui-multi-select
    class="mt-5"
    *tuiLet="participantsList$ | async as participants"
    formControlName="participants"
    [tuiTextfieldLabelOutside]="true"
    [stringify]="stringifyParticipants"
    [identityMatcher]="participantsMatcher"
    [tuiTextfieldCleaner]="true"
    [tuiDropdownDirection]="'bottom'"
    (searchChange)="searchParticipants($event)">
    Select participants
    <tui-data-list-wrapper
      *tuiDataList
      [items]="participants | tuiHideSelected"
      [itemContent]="participantsSelect">
    </tui-data-list-wrapper>
  </tui-multi-select>
  <div 
    class="text-rose-600 text-sm mt-1" 
    *ngIf="participantsField.errors && participantsField.touched && participantsField.errors['required']">
    <p>Select at leat 1 participant for call</p>
  </div>
  <button
    tuiButton
    type="submit"
    appearance="primary"
    size="m"
    icon="tuiIconPhone"
    class="mt-3">
    Create
  </button>
  <button
    tuiButton
    type="reset"
    appearance="secondary"
    size="m"
    class="mt-3 ml-3"
    (click)="cancel()">
    Cancel
  </button>
</form>
<ng-template #participantsSelect let-data>
  <div class="flex items-center">
    <tui-avatar
      size="m"
      [ngClass]="{'participant-avatar': data.isOnline}"
      class="mr-2"
      [avatarUrl]="data.avatarUrl">
    </tui-avatar>
    {{ data.name }}
  </div>
</ng-template>
